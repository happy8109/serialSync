<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SerialSync - 串口通信程序</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/fontawesome.min.css">
</head>

<body>
    <div class="container">
        <header class="header">
            <h1><i class="fas fa-microchip"></i> SerialSync</h1>
            <p>串口通信同步程序 <span id="versionText"></span></p>
        </header>

        <main class="main">
            <!-- 串口连接与配置面板（合并） -->
            <section class="panel connection-config-panel">
                <h2><i class="fas fa-plug"></i> 串口连接与配置</h2>
                <div class="status-grid">
                    <div class="status-item">
                        <span class="label">连接状态:</span>
                        <span class="value" id="connectionStatus">
                            <i class="fas fa-circle status-disconnected"></i> 未连接
                        </span>
                    </div>
                    <div class="status-item">
                        <span class="label">串口:</span>
                        <span class="value" id="portInfo">-</span>
                    </div>
                    <div class="status-item">
                        <span class="label">速率:</span>
                        <span class="value" id="speedInfo">-</span>
                    </div>
                    <div class="status-item">
                        <span class="label">当前任务:</span>
                        <span class="value" id="taskInfo">-</span>
                    </div>
                </div>

                <div class="config-form" style="margin-top: 1em;">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="portSelect">串口:</label>
                            <select id="portSelect" class="form-control">
                                <option value="">选择串口...</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="baudRate">波特率:</label>
                            <select id="baudRate" class="form-control">
                                <option value="9600">9600</option>
                                <option value="19200">19200</option>
                                <option value="38400">38400</option>
                                <option value="57600">57600</option>
                                <option value="115200" selected>115200</option>
                                <option value="230400">230400</option>
                                <option value="460800">460800</option>
                                <option value="921600">921600</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="dataBits">数据位:</label>
                            <select id="dataBits" class="form-control">
                                <option value="7">7</option>
                                <option value="8" selected>8</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="stopBits">停止位:</label>
                            <select id="stopBits" class="form-control">
                                <option value="1" selected>1</option>
                                <option value="2">2</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="parity">校验位:</label>
                            <select id="parity" class="form-control">
                                <option value="none" selected>无</option>
                                <option value="even">偶校验</option>
                                <option value="odd">奇校验</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <span class="label"></span>
                    <div class="connection-actions">
                        <button id="connectBtn" class="btn btn-primary">
                            <i class="fas fa-link"></i> 连接
                        </button>
                        <button id="disconnectBtn" class="btn btn-danger" disabled>
                            <i class="fas fa-unlink"></i> 断开
                        </button>
                        <button id="refreshPortsBtn" class="btn btn-secondary">
                            <i class="fas fa-sync-alt"></i> 刷新串口
                        </button>
                    </div>
                </div>
            </section>

            <!-- 聊天窗口式字符/文件传输面板 -->
            <section class="panel chat-panel">
                <h2><i class="fas fa-comments"></i> 聊天/字符&文件传输</h2>
                <div class="chat-container">
                    <div id="chatMessages" class="chat-messages"></div>
                    <div class="chat-input-row">
                        <input id="chatInput" class="form-control chat-input" type="text" placeholder="输入消息..."
                            autocomplete="off">
                        <button id="sendChatBtn" class="btn btn-success chat-send-btn">
                            <i class="fas fa-paper-plane"></i> 发送
                        </button>
                        <button id="fileSendBtn" class="btn btn-secondary chat-file-btn" title="发送文件（开发中）" disabled>
                            <i class="fas fa-file-upload"></i>
                        </button>
                    </div>
                </div>
            </section>

            <!-- 日志面板 -->
            <section class="panel log-panel">
                <h2><i class="fas fa-list-alt"></i> 系统日志</h2>
                <div class="log-container">
                    <div class="log-header">
                        <span>实时日志</span>
                        <div class="log-actions">
                            <button id="clearLogBtn" class="btn btn-sm btn-secondary">
                                <i class="fas fa-trash"></i> 清空
                            </button>
                            <button id="exportLogBtn" class="btn btn-sm btn-info">
                                <i class="fas fa-download"></i> 导出
                            </button>
                        </div>
                    </div>
                    <div id="logContent" class="log-content"></div>
                </div>
            </section>
        </main>

        <!-- 通知区域 -->
        <div id="notificationArea" class="notification-area"></div>
    </div>

    <!-- 加载指示器 -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div class="loading-spinner">
            <i class="fas fa-spinner fa-spin"></i>
            <span>处理中...</span>
        </div>
    </div>

    <script src="js/app.js"></script>
    <script>
window.SERIALSYNC_VERSION = 'v1.2.0';
document.addEventListener('DOMContentLoaded', function() {
  var v = window.SERIALSYNC_VERSION;
  var el = document.getElementById('versionText');
  if (el) el.textContent = v;
});
</script>
</body>

</html>