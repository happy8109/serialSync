<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SerialSync - 串口通信程序</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/fontawesome.min.css">
</head>

<body>
    <div class="container">
        <header class="header">
            <h1><i class="fas fa-microchip"></i> SerialSync</h1>
            <p>串口通信同步程序 <span id="versionText"></span></p>
        </header>

        <main class="main">
            <!-- 串口连接与配置面板（合并） -->
            <section class="panel connection-config-panel">
                <h2><i class="fas fa-plug"></i> 串口连接与配置</h2>
                <div class="status-grid">
                    <div class="status-item">
                        <span class="label">连接状态:</span>
                        <span class="value" id="connectionStatus">
                            <i class="fas fa-circle status-disconnected"></i> 未连接
                        </span>
                    </div>
                    <div class="status-item">
                        <span class="label">串口:</span>
                        <span class="value" id="portInfo">-</span>
                    </div>
                    <div class="status-item">
                        <span class="label">波特率:</span>
                        <span class="value" id="baudRateInfo">-</span>
                    </div>
                    <div class="status-item">
                        <span class="label">数据块大小:</span>
                        <span class="value" id="chunkSizeInfo">-</span>
                    </div>
                </div>
                <div class="form-group">
                    <span class="label"></span>
                    <div class="connection-actions">
                        <button id="connectBtn" class="btn btn-primary">
                            <i class="fas fa-link"></i> 连接
                        </button>
                        <button id="disconnectBtn" class="btn btn-danger" disabled>
                            <i class="fas fa-unlink"></i> 断开
                        </button>
                        <button id="configSerialBtn" class="btn btn-secondary">
                            <i class="fas fa-cog"></i> 配置串口
                        </button>
                    </div>
                </div>
            </section>

            <!-- 聊天和文件同步面板容器 -->
            <div class="panels-flex-container">
                <!-- 聊天窗口式字符/文件传输面板 -->
                <section class="panel chat-panel">
                    <h2><i class="fas fa-comments"></i> 字符传输&文件传输</h2>
                    <div class="chat-container">
                        <div id="chatMessages" class="chat-messages"></div>
                        <div class="chat-input-row">
                            <input id="chatInput" class="form-control chat-input" type="text" placeholder="输入消息..."
                                autocomplete="off">
                            <button id="sendChatBtn" class="btn btn-success chat-send-btn">
                                <i class="fas fa-paper-plane"></i> 发送信息
                            </button>
                            <button id="fileSendBtn" class="btn btn-secondary chat-file-btn">
                                <i class="fas fa-file-upload"></i> 文件传输
                            </button>
                        </div>
                    </div>
                </section>

                <!-- 文件同步面板 -->
                <section class="panel sync-panel">
                    <h2><i class="fas fa-sync-alt"></i> 文件同步</h2>
                    <div class="sync-container">
                        <div class="sync-status">
                            <p>文件同步功能开发中...</p>
                        </div>
                    </div>
                </section>
            </div>

            <!-- 日志面板 -->
            <section class="panel log-panel">
                <h2><i class="fas fa-list-alt"></i> 系统日志</h2>
                <div class="log-container">
                    <div class="log-header">
                        <span>实时日志</span>
                        <div class="log-actions">
                            <button id="clearLogBtn" class="btn btn-sm btn-secondary">
                                <i class="fas fa-trash"></i> 清空
                            </button>
                            <button id="exportLogBtn" class="btn btn-sm btn-info">
                                <i class="fas fa-download"></i> 导出
                            </button>
                        </div>
                    </div>
                    <div id="logContent" class="log-content"></div>
                </div>
            </section>
        </main>

        <!-- 通知区域 -->
        <div id="notificationArea" class="notification-area"></div>
    </div>

    <!-- 加载指示器 -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div class="loading-spinner">
            <i class="fas fa-spinner fa-spin"></i>
            <span>处理中...</span>
        </div>
    </div>

    <!-- 串口参数配置弹窗 -->
    <div id="serialConfigModal" class="modal" style="display:none;">
      <div class="modal-content">
        <span class="close" id="closeSerialConfigModal">&times;</span>
        <h3>串口参数配置</h3>
        
        <!-- Tab导航 -->
        <div class="tab-nav">
          <button class="tab-btn active" data-tab="serial">串口基本参数</button>
          <button class="tab-btn" data-tab="sync">文件传输参数</button>
        </div>
        
        <form id="serialConfigForm">
          <!-- 串口基本参数 Tab -->
          <div class="tab-content active" id="serial-tab">
            <div class="form-group">
              <label for="modalPortSelect">串口号:</label>
              <select id="modalPortSelect" class="form-control"></select>
            </div>
            <div class="form-group">
              <label for="modalBaudRate">波特率:</label>
              <select id="modalBaudRate" class="form-control">
                <option value="9600">9600</option>
                <option value="19200">19200</option>
                <option value="38400">38400</option>
                <option value="57600">57600</option>
                <option value="115200">115200</option>
                <option value="230400">230400</option>
                <option value="460800">460800</option>
                <option value="921600">921600</option>
              </select>
            </div>
            <div class="form-group">
              <label for="modalDataBits">数据位:</label>
              <select id="modalDataBits" class="form-control">
                <option value="7">7</option>
                <option value="8">8</option>
              </select>
            </div>
            <div class="form-group">
              <label for="modalStopBits">停止位:</label>
              <select id="modalStopBits" class="form-control">
                <option value="1">1</option>
                <option value="2">2</option>
              </select>
            </div>
            <div class="form-group">
              <label for="modalParity">校验位:</label>
              <select id="modalParity" class="form-control">
                <option value="none">无</option>
                <option value="even">偶校验</option>
                <option value="odd">奇校验</option>
              </select>
            </div>
          </div>
          
          <!-- 文件传输参数 Tab -->
          <div class="tab-content" id="sync-tab">
            <div class="form-group">
              <label for="modalChunkSize">数据块大小 (字节):</label>
              <select id="modalChunkSize" class="form-control">
                <option value="1024">1KB</option>
                <option value="2048">2KB</option>
                <option value="4096">4KB</option>
                <option value="8192">8KB</option>
                <option value="16384">16KB</option>
                <option value="32768">32KB</option>
                <option value="65536">64KB</option>
                <option value="131072">128KB</option>
              </select>
            </div>
            <div class="form-group">
              <label for="modalTimeout">超时时间 (毫秒):</label>
              <input type="number" id="modalTimeout" class="form-control" min="10" max="10000" step="10">
            </div>
            <div class="form-group">
              <label for="modalRetryAttempts">重试次数:</label>
              <input type="number" id="modalRetryAttempts" class="form-control" min="0" max="10" step="1">
            </div>
            <div class="form-group">
              <label for="modalCompression">启用压缩:</label>
              <select id="modalCompression" class="form-control">
                <option value="true">是</option>
                <option value="false">否</option>
              </select>
            </div>
            <div class="form-group">
              <label for="modalAutoAccept">自动接收文件:</label>
              <select id="modalAutoAccept" class="form-control">
                <option value="true">是</option>
                <option value="false">否</option>
              </select>
            </div>
          </div>
          
          <div class="form-group" style="margin-top:1em;">
            <button type="submit" class="btn btn-primary">保存</button>
          </div>
        </form>
      </div>
    </div>

    <script src="js/app.js"></script>
    <script>
window.SERIALSYNC_VERSION = 'v1.2.0';
document.addEventListener('DOMContentLoaded', function() {
  var v = window.SERIALSYNC_VERSION;
  var el = document.getElementById('versionText');
  if (el) el.textContent = v;
});
</script>
</body>

</html>